      SUBROUTINE READ_DIST(LFNAM,KNUM,DIS_DAT)
      IMPLICIT REAL*8(A-H,O-Z)

	CHARACTER*180 BUFF180
      DIMENSION DIS_DAT(3,6000)
      DIMENSION DIS_DAT1(6000),DIS_DAT2(6000),DIS_DAT3(6000)
      INTEGER(4) LFNAM

       TIME0 = 0.0D0
       KNUM = 0
       DIS_DAT1(1:6000) = 0.0D0
       DIS_DAT2(1:6000) = 0.0D0 
       DIS_DAT3(1:6000) = 0.0D0
       READ (LFNAM,*)
         
       DO I = 1,999999
       READ (LFNAM,'(A180)',END=199) BUFF180
        IF(BUFF180(1:4).EQ.'0102'.OR.BUFF180(1:4).EQ.'0201') KK = 102
        IF(BUFF180(1:4).EQ.'0103'.OR.BUFF180(1:4).EQ.'0301') KK = 103
        IF(BUFF180(1:4).EQ.'0104'.OR.BUFF180(1:4).EQ.'0401') KK = 104
        IF(BUFF180(1:4).EQ.'0203'.OR.BUFF180(1:4).EQ.'0302') KK = 203
        IF(BUFF180(1:4).EQ.'0204'.OR.BUFF180(1:4).EQ.'0402') KK = 204
        IF(BUFF180(1:4).EQ.'0304'.OR.BUFF180(1:4).EQ.'0403') KK = 304
        IF(BUFF180(1:2).EQ.'05'.OR.BUFF180(3:4).EQ.'05') GOTO 198
        KNUM = KNUM + 1
        READ (BUFF180,110,END=999) IYEAR,IMONTH,IDAY
     1         ,IHOUR,IMIN,SEC,IDIST
110     FORMAT(6X,I4,4(1X,I2),1X,F6.3,20X,I7)
        DIST = DBLE(IDIST)*1.0D-6
        TEMP = DBLE(IDAY-14)*86400.0D0 + DBLE(IHOUR)*3600.0D0 + 
     1         DBLE(IMIN)*60.0D0 + SEC - TIME0

       DIS_DAT1(KNUM) = TEMP
       DIS_DAT2(KNUM) = KK
       DIS_DAT3(KNUM) = DIST
198   CONTINUE
       ENDDO
199   CONTINUE

      CALL SORT3(KNUM,DIS_DAT1,DIS_DAT2,DIS_DAT3)

       DIS_DAT(1,1:KNUM) = DIS_DAT1(1:KNUM)
       DIS_DAT(2,1:KNUM) = DIS_DAT2(1:KNUM)
       DIS_DAT(3,1:KNUM) = DIS_DAT3(1:KNUM)


999   CONTINUE
       RETURN
	END
